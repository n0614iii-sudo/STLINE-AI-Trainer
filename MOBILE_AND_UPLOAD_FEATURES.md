# 📱 モバイル対応 & 動画・画像アップロード機能

## ✅ 実装完了

スマホ・iPad対応と動画・画像アップロード機能を追加しました！

## 📱 モバイル・タブレット対応

### 実装内容

1. **レスポンシブデザイン**
   - スマホ（576px以下）: 最適化されたレイアウト
   - タブレット（768px-1024px）: iPad対応
   - 横向きモード: 自動調整

2. **モバイルメニュー**
   - ハンバーガーメニューボタン
   - スライドインサイドバー
   - タッチ操作最適化

3. **タッチデバイス最適化**
   - ホバー効果の調整
   - タッチ操作の最適化
   - パフォーマンス向上（パーティクル数削減）

4. **フォント・サイズ調整**
   - モバイル用フォントサイズ
   - 読みやすい文字サイズ
   - タッチしやすいボタンサイズ

## 🎥 動画・画像アップロード機能

### 対応形式

**画像:**
- JPG / JPEG
- PNG
- GIF

**動画:**
- MP4
- MOV
- AVI
- WEBM

### 機能

1. **ドラッグ&ドロップ**
   - ファイルをドラッグ&ドロップでアップロード
   - 視覚的フィードバック

2. **ファイル選択**
   - ファイル選択ダイアログ
   - モバイル対応

3. **進捗表示**
   - アップロード進捗バー
   - リアルタイム進捗表示

4. **姿勢分析**
   - **画像**: 1フレームから姿勢分析
   - **動画**: 複数フレーム（最初、中間、最後）から姿勢分析
   - 自動キーポイント検出
   - 詳細な分析結果

### 使用方法

1. **姿勢診断ページにアクセス**
   - ユーザーを選択
   - 姿勢診断ページを開く

2. **ファイルをアップロード**
   - ドラッグ&ドロップエリアにファイルをドロップ
   - または「ファイルを選択」ボタンをクリック

3. **姿勢分析**
   - アップロード後、自動的に姿勢分析が開始
   - 進捗バーで進捗を確認

4. **結果を確認**
   - 分析結果が自動的に表示
   - 総合スコア、問題点、改善提案を確認

## 🔧 技術詳細

### バックエンド

- **ファイルアップロード**: Flask `request.files`
- **ファイル保存**: `uploads/` ディレクトリ
- **動画処理**: OpenCV (`cv2.VideoCapture`)
- **画像処理**: OpenCV (`cv2.imread`)
- **姿勢検出**: YOLO11-Pose
- **姿勢分析**: `PostureAnalyzer`

### フロントエンド

- **ドラッグ&ドロップ**: HTML5 Drag & Drop API
- **ファイル選択**: HTML5 File API
- **進捗表示**: XMLHttpRequest with progress events
- **レスポンシブ**: CSS Media Queries

### APIエンドポイント

```
POST /api/posture/upload
Content-Type: multipart/form-data

Parameters:
- file: 画像または動画ファイル
- user_id: ユーザーID
- posture_type: 姿勢タイプ (standing, sitting, walking)

Response:
{
  "status": "success",
  "message": "姿勢分析が完了しました",
  "file_url": "/uploads/videos/...",
  "analysis": {
    "overall_score": 0.85,
    "issues": [...],
    "recommendations": [...],
    ...
  }
}
```

## 📊 動画分析の仕組み

1. **フレーム抽出**
   - 最初のフレーム
   - 中間フレーム
   - 最後のフレーム

2. **姿勢検出**
   - 各フレームからキーポイントを検出
   - YOLO11-Poseを使用

3. **分析統合**
   - 複数フレームの平均スコアを計算
   - 問題点を統合
   - 推奨事項を生成

## 🎯 モバイル最適化

### パフォーマンス

- モバイルではパーティクル数を削減（40個）
- 3D効果を軽量化
- 画像の最適化

### UX改善

- タッチ操作に最適化
- 大きなタップターゲット
- スワイプ操作対応

## 🚀 次のステップ

1. **Railwayで再デプロイ**
   - 変更が自動的にデプロイされます

2. **モバイルでテスト**
   - スマホ・iPadでアクセス
   - ファイルアップロードを試す

3. **姿勢診断を試す**
   - 画像をアップロード
   - 動画をアップロード
   - 結果を確認

## 📝 注意事項

- 最大ファイルサイズ: 100MB
- 動画の処理には時間がかかる場合があります
- 大きな動画ファイルは処理に時間がかかります

## 🎉 まとめ

- ✅ スマホ・iPad完全対応
- ✅ 動画・画像アップロード機能
- ✅ ドラッグ&ドロップ対応
- ✅ 進捗表示
- ✅ 自動姿勢分析

モバイルでも快適に使用でき、動画・画像からも姿勢診断が可能になりました！

