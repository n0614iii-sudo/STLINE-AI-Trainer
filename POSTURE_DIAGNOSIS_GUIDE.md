# 🧘 姿勢診断機能ガイド

## 📋 機能概要

姿勢診断機能は、YOLO11-Poseを使用してリアルタイムで姿勢を分析し、問題点を特定して改善提案を行う機能です。

## 🎯 主な機能

### 1. リアルタイム姿勢分析
- カメラを使用してリアルタイムで姿勢を検出
- YOLO11-Poseによる17個のキーポイント検出
- 5秒ごとの自動分析

### 2. 姿勢評価項目

#### 整列スコア（0.0-1.0）
- **肩の水平度**: 左右の肩の高さの違い
- **骨盤の水平度**: 骨盤の左右の高さの違い
- **頭部の位置**: 頭部が中心からずれていないか
- **背骨の整列**: 背骨が一直線上にあるか
- **膝の位置**: 左右の膝の高さの違い

#### 検出される問題
- **肩の高さの違い**: 左右の肩の高さが異なる
- **骨盤の傾き**: 骨盤が左右に傾いている
- **猫背**: 前傾姿勢（Forward Head Posture）
- **反り腰**: 後傾姿勢（Sway Back）
- **ストレートネック**: 首が前に出ている
- **頭部の位置ずれ**: 頭部が中心からずれている
- **背骨の歪み**: 背骨が一直線上にない

### 3. 改善提案
検出された問題に基づいて、具体的な改善提案を表示：
- ストレッチ方法
- エクササイズ推奨
- 日常的な注意点

### 4. 診断履歴
- 過去の診断結果を保存
- 30日間のサマリー表示
- 改善傾向の可視化

## 🚀 使用方法

### ステップ1: 姿勢診断ページにアクセス

1. Webダッシュボードで「姿勢診断」をクリック
2. または、直接 `/posture_diagnosis` にアクセス

### ステップ2: ユーザーを選択

1. 診断したいユーザーを選択
2. 「姿勢診断を開始」をクリック

### ステップ3: カメラの許可

1. ブラウザがカメラへのアクセスを要求
2. 「許可」をクリック

### ステップ4: 姿勢診断を開始

1. 「診断開始」ボタンをクリック
2. カメラの前に立ち、正しい姿勢を取る
3. 5秒ごとに自動的に姿勢が分析されます

### ステップ5: 結果を確認

1. 診断結果が自動的に表示されます
2. 総合スコア、問題点、改善提案を確認
3. 「現在の姿勢を分析」ボタンで手動分析も可能

## 📊 診断結果の見方

### 総合スコア
- **80点以上**: 良好な姿勢
- **60-79点**: やや改善が必要
- **60点未満**: 改善が必要

### 問題の深刻度
- **high**: 深刻な問題（早急な改善が必要）
- **medium**: 中程度の問題（改善を推奨）
- **low**: 軽微な問題（注意が必要）

## 🔧 技術詳細

### 使用技術
- **YOLO11-Pose**: 姿勢検出モデル
- **OpenCV**: 画像処理
- **NumPy**: 数値計算
- **Flask**: Web API

### APIエンドポイント

#### 姿勢分析
```
POST /api/posture/analyze
{
    "user_id": "user001",
    "keypoints": {...},  // オプション
    "image": "base64...", // オプション（画像データ）
    "posture_type": "standing"
}
```

#### 診断履歴
```
GET /api/posture/history/<user_id>
```

#### 診断サマリー
```
GET /api/posture/summary/<user_id>?days=30
```

## 📝 注意事項

1. **カメラの位置**: カメラは正面から全身が映る位置に配置してください
2. **照明**: 十分な照明が必要です
3. **服装**: 体の輪郭が分かりやすい服装を推奨
4. **背景**: シンプルな背景が検出精度を向上させます

## 🎯 今後の拡張予定

- [ ] 動的姿勢分析（歩行、ランニングなど）
- [ ] 姿勢改善プログラムの自動生成
- [ ] 3D姿勢可視化
- [ ] 姿勢改善の進捗追跡
- [ ] 複数ユーザーの比較分析

## 📚 関連ドキュメント

- `posture_analyzer.py`: 姿勢分析エンジン
- `posture_detector.py`: YOLO11-Pose検出器
- `gym_dashboard.py`: Webインターフェース

