# ğŸ”§ é ­éƒ¨ä½ç½®æ¤œå‡ºã®ä¿®æ­£

## âœ… ä¿®æ­£å®Œäº†

é ­éƒ¨ã®ä½ç½®æ¤œå‡ºã®ç²¾åº¦ã‚’æ”¹å–„ã—ã¾ã—ãŸï¼

## ğŸ› å•é¡Œç‚¹

### å¾“æ¥ã®å®Ÿè£…ã®å•é¡Œ
1. **é¼»ã®ã¿ã‚’ä½¿ç”¨**: é¼»ã ã‘ã‚’ä½¿ã£ã¦ã„ãŸãŸã‚ã€é ­éƒ¨ã®ä¸­å¿ƒä½ç½®ãŒä¸æ­£ç¢º
2. **å·¦å³ã®ãšã‚Œã®ã¿è©•ä¾¡**: å‰å¾Œã®ä½ç½®ï¼ˆå‰å‚¾ãƒ»å¾Œå‚¾ï¼‰ã‚’è€ƒæ…®ã—ã¦ã„ãªã„
3. **å§¿å‹¢ã‚¿ã‚¤ãƒ—ã‚’è€ƒæ…®ã—ãªã„**: æ¨ªå‘ãã‚„èƒŒé¢ã®å§¿å‹¢ã§é©åˆ‡ã«è©•ä¾¡ã§ããªã„

## ğŸ”§ ä¿®æ­£å†…å®¹

### 1. é ­éƒ¨ã®ä¸­å¿ƒä½ç½®ã®æ”¹å–„

**å¾“æ¥:**
- é¼»ï¼ˆnoseï¼‰ã®ã¿ã‚’ä½¿ç”¨

**æ”¹å–„å¾Œ:**
- **å„ªå…ˆé †ä½1**: è€³ã®ä¸­å¿ƒï¼ˆleft_ear, right_earï¼‰ã‚’ä½¿ç”¨
  - ã‚ˆã‚Šæ­£ç¢ºãªé ­éƒ¨ã®ä¸­å¿ƒä½ç½®
  - ä¿¡é ¼åº¦ãŒ0.3ä»¥ä¸Šã®å ´åˆã®ã¿ä½¿ç”¨
- **å„ªå…ˆé †ä½2**: ç›®ã¨é¼»ã®ä¸­å¿ƒã‚’ä½¿ç”¨
  - è€³ãŒæ¤œå‡ºã•ã‚Œãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  - è¤‡æ•°ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆã®å¹³å‡ã‚’ä½¿ç”¨

### 2. è©•ä¾¡æ–¹æ³•ã®æ”¹å–„

**å¾“æ¥:**
- å·¦å³ã®ãšã‚Œï¼ˆXæ–¹å‘ï¼‰ã®ã¿è©•ä¾¡

**æ”¹å–„å¾Œ:**
- **å·¦å³ã®ãšã‚Œï¼ˆXæ–¹å‘ï¼‰**: 60%ã®é‡ã¿
  - æ­£å¸¸ç¯„å›²: ä½“é«˜ã®2%ä»¥å†…
  - è¨±å®¹ç¯„å›²: ä½“é«˜ã®5%ä»¥å†…
- **å‰å¾Œã®ãšã‚Œï¼ˆYæ–¹å‘ï¼‰**: 40%ã®é‡ã¿
  - æ­£å¸¸ç¯„å›²: ä½“é«˜ã®3%ä»¥å†…
  - è¨±å®¹ç¯„å›²: ä½“é«˜ã®6%ä»¥å†…
  - é ­éƒ¨ã¯è‚©ã‚ˆã‚Šç´„12%ä¸Šã«ã‚ã‚‹ã“ã¨ã‚’æœŸå¾…

### 3. å•é¡Œæ¤œå‡ºã®æ”¹å–„

**å¾“æ¥:**
- ã‚¹ã‚³ã‚¢ãŒ0.7æœªæº€ã®å ´åˆã®ã¿å•é¡Œã¨ã—ã¦æ¤œå‡º
- æ·±åˆ»åº¦ã¯å¸¸ã«"medium"

**æ”¹å–„å¾Œ:**
- **é«˜ï¼ˆhighï¼‰**: ã‚¹ã‚³ã‚¢0.5æœªæº€
  - "é ­éƒ¨ãŒå¤§ããä¸­å¿ƒã‹ã‚‰ãšã‚Œã¦ã„ã¾ã™"
- **ä¸­ï¼ˆmediumï¼‰**: ã‚¹ã‚³ã‚¢0.5-0.7
  - "é ­éƒ¨ãŒä¸­å¿ƒã‹ã‚‰ãšã‚Œã¦ã„ã¾ã™"
- **ä½ï¼ˆlowï¼‰**: ã‚¹ã‚³ã‚¢0.7-0.85
  - "é ­éƒ¨ãŒã‚ãšã‹ã«ä¸­å¿ƒã‹ã‚‰ãšã‚Œã¦ã„ã¾ã™"

### 4. å¯è¦–åŒ–ã®æ”¹å–„

**å¾“æ¥:**
- è‚©ã®ä¸­å¿ƒã‹ã‚‰é¼»ã¸ã®ç·šã‚’æç”»

**æ”¹å–„å¾Œ:**
- è‚©ã®ä¸­å¿ƒã‹ã‚‰é ­éƒ¨ã®ä¸­å¿ƒï¼ˆè€³ã®ä¸­å¿ƒã¾ãŸã¯ç›®ã¨é¼»ã®ä¸­å¿ƒï¼‰ã¸ã®ç·šã‚’æç”»
- ã‚ˆã‚Šæ­£ç¢ºãªé ­éƒ¨ä½ç½®ã‚’è¡¨ç¤º

## ğŸ“Š è©•ä¾¡åŸºæº–

### å·¦å³ã®ãšã‚Œï¼ˆXæ–¹å‘ï¼‰
- **æ­£å¸¸ç¯„å›²**: ä½“é«˜ã®2%ä»¥å†…ï¼ˆç´„2cmï¼‰
- **è¨±å®¹ç¯„å›²**: ä½“é«˜ã®5%ä»¥å†…ï¼ˆç´„5cmï¼‰
- **å•é¡Œç¯„å›²**: ä½“é«˜ã®5%ä»¥ä¸Š

### å‰å¾Œã®ãšã‚Œï¼ˆYæ–¹å‘ï¼‰
- **æ­£å¸¸ç¯„å›²**: ä½“é«˜ã®3%ä»¥å†…ï¼ˆç´„3cmï¼‰
- **è¨±å®¹ç¯„å›²**: ä½“é«˜ã®6%ä»¥å†…ï¼ˆç´„6cmï¼‰
- **å•é¡Œç¯„å›²**: ä½“é«˜ã®6%ä»¥ä¸Š

### çµ±åˆã‚¹ã‚³ã‚¢
- å·¦å³ã®ã‚¹ã‚³ã‚¢ Ã— 0.6 + å‰å¾Œã®ã‚¹ã‚³ã‚¢ Ã— 0.4

## ğŸ¯ æ”¹å–„ã®åŠ¹æœ

### ç²¾åº¦å‘ä¸Š
- âœ… ã‚ˆã‚Šæ­£ç¢ºãªé ­éƒ¨ã®ä¸­å¿ƒä½ç½®ã®æ¤œå‡º
- âœ… å·¦å³ã ã‘ã§ãªãå‰å¾Œã®ä½ç½®ã‚‚è©•ä¾¡
- âœ… è¤‡æ•°ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸã‚ˆã‚Šæ­£ç¢ºãªè©•ä¾¡

### å•é¡Œæ¤œå‡ºã®æ”¹å–„
- âœ… ã‚ˆã‚Šè©³ç´°ãªæ·±åˆ»åº¦ã®åˆ†é¡
- âœ… ã‚ˆã‚Šé©åˆ‡ãªå•é¡Œã®èª¬æ˜
- âœ… ã‚ˆã‚Šæ­£ç¢ºãªå½±éŸ¿ã®èª¬æ˜

### å¯è¦–åŒ–ã®æ”¹å–„
- âœ… ã‚ˆã‚Šæ­£ç¢ºãªé ­éƒ¨ä½ç½®ã®è¡¨ç¤º
- âœ… ã‚ˆã‚Šè¦‹ã‚„ã™ã„ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆç·š

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Railwayã§å†ãƒ‡ãƒ—ãƒ­ã‚¤**
   - å¤‰æ›´ãŒè‡ªå‹•çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™

2. **å§¿å‹¢è¨ºæ–­ã‚’å®Ÿè¡Œ**
   - é ­éƒ¨ä½ç½®ã®æ¤œå‡ºãŒæ”¹å–„ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
   - ã‚ˆã‚Šæ­£ç¢ºãªè©•ä¾¡ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

3. **ç¢ºèªäº‹é …**
   - é ­éƒ¨ä½ç½®ãŒæ­£ç¢ºã«æ¤œå‡ºã•ã‚Œã‚‹
   - å·¦å³ã¨å‰å¾Œã®ä¸¡æ–¹ãŒè©•ä¾¡ã•ã‚Œã‚‹
   - å•é¡Œæ¤œå‡ºãŒã‚ˆã‚Šè©³ç´°ã«ãªã‚‹

## ğŸ“‹ æŠ€è¡“è©³ç´°

### é ­éƒ¨ã®ä¸­å¿ƒä½ç½®ã®è¨ˆç®—

```python
# å„ªå…ˆé †ä½1: è€³ã®ä¸­å¿ƒ
if "left_ear" in keypoints and "right_ear" in keypoints:
    le = keypoints["left_ear"]
    re = keypoints["right_ear"]
    if le.confidence > 0.3 and re.confidence > 0.3:
        head_center_x = (le.x + re.x) / 2
        head_center_y = (le.y + re.y) / 2

# å„ªå…ˆé †ä½2: ç›®ã¨é¼»ã®ä¸­å¿ƒ
if head_center_x is None:
    head_points = []
    if "left_eye" in keypoints: head_points.append(keypoints["left_eye"])
    if "right_eye" in keypoints: head_points.append(keypoints["right_eye"])
    if "nose" in keypoints: head_points.append(keypoints["nose"])
    
    if len(head_points) >= 2:
        head_center_x = sum(p.x for p in head_points) / len(head_points)
        head_center_y = sum(p.y for p in head_points) / len(head_points)
```

### è©•ä¾¡ã®è¨ˆç®—

```python
# å·¦å³ã®ãšã‚Œ
horizontal_offset = abs(head_center_x - shoulder_center_x)
score_h = calculate_score(horizontal_offset, normal_threshold_h, acceptable_threshold_h)

# å‰å¾Œã®ãšã‚Œ
expected_head_y = shoulder_center_y - body_height * 0.12
vertical_offset = abs(head_center_y - expected_head_y)
score_v = calculate_score(vertical_offset, normal_threshold_v, acceptable_threshold_v)

# çµ±åˆã‚¹ã‚³ã‚¢
head_alignment = score_h * 0.6 + score_v * 0.4
```

## ğŸ‰ ã¾ã¨ã‚

é ­éƒ¨ä½ç½®ã®æ¤œå‡ºã‚’æ”¹å–„ã—ã¾ã—ãŸï¼š

- âœ… è€³ã®ä¸­å¿ƒã‚’ä½¿ç”¨ï¼ˆã‚ˆã‚Šæ­£ç¢ºãªé ­éƒ¨ã®ä¸­å¿ƒä½ç½®ï¼‰
- âœ… å·¦å³ã¨å‰å¾Œã®ä¸¡æ–¹ã‚’è©•ä¾¡
- âœ… ã‚ˆã‚Šè©³ç´°ãªæ·±åˆ»åº¦ã®åˆ†é¡
- âœ… ã‚ˆã‚Šæ­£ç¢ºãªå¯è¦–åŒ–

Railwayã§å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ãŸã‚‰ã€é ­éƒ¨ä½ç½®ã®æ¤œå‡ºãŒã‚ˆã‚Šæ­£ç¢ºã«ãªã‚‹ã¯ãšã§ã™ï¼



